(()=>{"use strict";const t="b64784ee65e54392b7670004231608",e="https://api.weatherapi.com/v1/";async function n(t,e){const n=document.createElement("div");n.classList.add("forecastDataContainer");const i=window.localStorage.getItem("tempScale"),c=o("div","date",["day"],e.date);let d,r;"°C"===i?(d=o("div","maxTemp",["temp"],`${e.max_temp_c} ${i}`),r=o("div","minTemp",["temp"],`${e.min_temp_c} ${i}`)):(d=o("div","maxTemp",["temp"],`${e.max_temp_f} ${i}`),r=o("div","minTemp",["temp"],`${e.min_temp_f} ${i}`));const s=o("p",`${e.date}-conditionText`,["condition"],e.condition.text),l=document.createElement("div"),m=await a(e.condition.text),p=o("img",`${e.date}-conditionIcon`,["condition"],`./weatherIcons/${m}`);l.appendChild(p),l.classList.add("forecastConditionIconContainer"),n.appendChild(c),n.appendChild(d),n.appendChild(r),n.appendChild(s),n.appendChild(l),t.appendChild(n)}function o(t,e,n,o){const i=document.createElement(t);return e&&i.setAttribute("id",e),n.length&&i.classList.add(...n),o&&("img"===t?i.src=o:i.innerHTML=o),i}function i(t){for(;t.firstChild;)t.removeChild(t.firstChild)}async function a(t){const e=t.toLowerCase().split(" "),n=await fetch("./iconMapping.json"),o=await n.json();let i;return e.forEach((t=>{for(let e=0;e<o.length;e++)if(o[e].condition.includes(t))return console.log(" This is the icon name "+o[e].icon),void(i=o[e].icon)})),i}const c=document.querySelector("#searchContainer"),d=new class{constructor(t,e,n){this.buttonText=e,this.items=n,this.parent=t,this.iconURL=document.createElement("link"),this.container=document.createElement("div"),this.dropDownButton=document.createElement("button"),this.arrowIcon=document.createElement("span"),this.dropDownItems=document.createElement("div"),this.buttonTextElement=document.createElement("div")}createDropdown(){this.iconURL.rel="stylesheet",this.iconURL.href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200",document.head.appendChild(this.iconURL),this.container.classList.add("dropDownContainer"),this.dropDownButton.classList.add("dropDownButton"),this.arrowIcon.classList.add("material-symbols-outlined"),this.dropDownItems.classList.add("dropDownItems"),this.buttonTextElement.innerHTML=this.buttonText,this.dropDownButton.type="button",this.arrowIcon.innerHTML="expand_less";for(const t of this.items)this.addDropDownItem(t);this.dropDownButton.appendChild(this.buttonTextElement),this.dropDownButton.appendChild(this.arrowIcon),this.container.appendChild(this.dropDownButton),this.container.appendChild(this.dropDownItems),this.parent.appendChild(this.container)}addDropDownItem(t){const e=document.createElement("a");e.innerHTML=t,e.classList.add("item"),this.dropDownItems.appendChild(e)}initiateDropDown(){this.dropDownButton.addEventListener("click",(()=>{this.arrowIcon.classList.toggle("rotateIconDown"),setTimeout((()=>{this.dropDownItems.classList.toggle("visible")}),250)}))}}(c,"°C",["°C","°F"]);d.createDropdown(),d.initiateDropDown();const r=document.querySelector("#displayData"),s=document.querySelector("#forecast");window.localStorage.getItem("tempScale")||window.localStorage.setItem("tempScale","°C"),function(c,d,r){document.querySelector("#currentWeatherBtn").addEventListener("click",(async()=>{let c=document.querySelector("#locationSearch").value,s=await async function(n){document.querySelector("#displayData");try{let o=await fetch(`${e}current.json?key=${t}&q=${n}`);200!==o.status&&alert(o);let i=await o.json();return console.log(i),function(t){let e={};return e.locationName=t.location.name,e.region=t.location.region,e.country=t.location.country,e.temp_c=t.current.temp_c,e.temp_f=t.current.temp_f,e.condition=t.current.condition,e.humidity=t.current.humidity,e}(i)}catch(t){alert(t)}}(c),l=await async function(n){try{let o=await fetch(`${e}forecast.json?key=${t}&q=${n}&days=3`);200!==o.status&&alert(o);let i=await o.json();return console.log(i),function(t){let e=t.forecast.forecastday,n={},o=0;for(const t of e)n[t.date]={},n[t.date].date=t.date,n[t.date].avg_temp_c=e[o].day.avgtemp_c,n[t.date].avg_temp_f=e[o].day.avgtemp_f,n[t.date].avg_humidity=e[o].day.avghumidity,n[t.date].condition=e[o].day.condition,n[t.date].min_temp_c=e[o].day.mintemp_c,n[t.date].max_temp_c=e[o].day.maxtemp_c,n[t.date].min_temp_f=e[o].day.mintemp_f,n[t.date].max_temp_f=e[o].day.maxtemp_f,o++;return n}(i)}catch(t){alert(t)}}(c);await async function(t,e){i(t);const n=o("div","currentWeatherContainer",["weatherContainer"]),c=window.localStorage.getItem("tempScale"),d=o("div","currentLocation",["location"],`${e.locationName}, ${e.region}`),r=o("div","currentCountry",["country"],e.country);let s;s=o("div","currentTemp",["temp"],"°C"===c?`${e.temp_c} ${c}`:`${e.temp_f} ${c}`);const l=o("div","currentHumidity",["humidity"],`Humidity: ${e.humidity}%`),m=o("p","currentConditionText",["condition"],e.condition.text),p=document.createElement("div"),u=o("img","currentConditionIcon",["current-condition"],`./weatherIcons/${await a(e.condition.text)}`);p.appendChild(u),p.classList.add("conditionIconContainer"),n.appendChild(d),n.appendChild(r),n.appendChild(s),n.appendChild(l),n.appendChild(m),n.appendChild(p),t.appendChild(n)}(d,s),await function(t,e){i(t);for(const o in e)n(t,e[o])}(r,l)}))}(0,r,s);const l=document.querySelector(".dropDownItems"),m=document.querySelector(".dropDownButton"),p=document.querySelector("#currentWeatherBtn");for(const t of l.children)console.log(t),t.addEventListener("click",(()=>{window.localStorage.setItem("tempScale",t.innerHTML),m.firstChild.textContent=t.innerHTML,m.click(),p.click()}))})();